import './polyfills.server.mjs';
import{A as S,a as g,b as n,c as m}from"./chunk-NL7WNEJB.mjs";import{Rb as p,S as y,W as s,Z as a,b as l,o as u,rc as c}from"./chunk-QBAPEAMH.mjs";p();var f=(()=>{let r=class r{constructor(e,t){this.http=e,this.localStorage=t,this.baseUrl=g.apiUrl,this.cart=[],this.subTotal=0}getTotalQty(){return this.cart?.reduce((e,t)=>e+=t.quantity,0)}getTotalPrice(){return this.cart?.reduce((e,t)=>e+=t.totalAmount,0)}addToCart(e,t){this.getLocalStorage(),this.cart.find(h=>h._id===t)?this.addOne(t):this.cart.push(e),this.setLocalStorage()}deleteCart(e){let t=this.cart.filter(i=>i._id!==e);this.cart=[...t],this.setLocalStorage()}addOne(e){let t=this.cart.find(i=>i._id===e);t.quantity=t.quantity+1,t.totalAmount=t.price*t.quantity,this.cart=[...this.cart],this.setLocalStorage(),this.getLocalStorage()}minusOne(e){let t=this.cart.find(i=>i._id===e);t.quantity>1&&(t.quantity=t.quantity-1,t.totalAmount=t.price*t.quantity,this.cart=[...this.cart],this.setLocalStorage(),this.getLocalStorage())}setLocalStorage(){this.cart=this.localStorage.store("shopping-cart",this.cart)}getLocalStorage(){this.cart=this.localStorage.retrieve("shopping-cart")}isEmptyCart(){return this.cart?.length===0}clearAllCart(){this.cart=[],this.setLocalStorage()}};r.\u0275fac=function(t){return new(t||r)(a(c),a(n))},r.\u0275prov=s({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();y();var d={production:!0,apiUrl:"https://project-server-sdwr.onrender.com",jwtSecret:"prod-secret-key"};p();var C=(()=>{let r=class r{constructor(e,t,i,h,v){this.http=e,this._localStorage=t,this.$sessionStorage=i,this.accountSrv=h,this.cartSrv=v,this.baseUrl=d.apiUrl}login(e){return this.http.post(`${this.baseUrl}/auth/login`,e).pipe(u(t=>this.authenticateSuccess(t,!0)))}logout(){return new l(e=>{this._localStorage.clear("authToken"),this.$sessionStorage.clear("authToken"),this._localStorage.clear("shopping-cart"),this._localStorage.clear("role"),e.complete()})}signUp(e){return this.accountSrv.createUser(e)}authenticateSuccess(e,t){let i=e.data.access_token;t?(this._localStorage.store("authToken",i),this.$sessionStorage.clear("authToken")):(this.$sessionStorage.store("authToken",i),this._localStorage.clear("authToken"))}isMatchPassword(e,t){debugger;return e===t}};r.\u0275fac=function(t){return new(t||r)(a(c),a(n),a(m),a(S),a(f))},r.\u0275prov=s({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();export{f as a,C as b};
