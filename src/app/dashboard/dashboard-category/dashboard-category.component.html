<button nz-button nzType="primary" (click)="showModal()">+ Add</button>
<nz-table
  ngSkipHydration
  [nzTitle]="'All Category'"
  #basicTable
  [nzData]="categories"
>
  <thead>
    <tr>
      <th>Image</th>
      <th nzCustomFilter>
        Name
        <nz-filter-trigger
          [(nzVisible)]="visibleSearch"
          [nzActive]="searchValue.length > 0"
          [nzDropdownMenu]="menu"
        >
          <span nz-icon nzType="search"></span>
        </nz-filter-trigger>
      </th>
      <th>Products</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let data of basicTable.data">
      <td>
        <img
          [src]="
            data.avatarUrl || '../../../assets/images/categories/unknown.png'
          "
          [alt]="data.name"
        />
      </td>
      <td style="vertical-align: middle">{{ data.name }}</td>
      <td style="vertical-align: middle">
        {{ data.product?.length > 0 ? data.product.length : "Empty" }}
      </td>
      <td style="vertical-align: middle">
        <app-switch
          (click)="toggleActive(data)"
          [switchValue]="data.status"
        ></app-switch>
      </td>
      <td style="vertical-align: middle">
        <a>
          <button nz-button nzType="default" (click)="patchValue(data)">
            <span nz-icon nzType="edit" nzTheme="outline"></span>
            Edit
          </button>
        </a>
        <nz-divider nzType="vertical"></nz-divider>
        <a>
          <button
            nz-button
            nzType="primary"
            nzDanger
            nz-popconfirm
            nzPopconfirmTitle="Are you sure?"
            nzOkText="ok"
            nzCancelText="cancel"
            (nzOnConfirm)="delete(data._id)"
          >
            <span nz-icon nzType="delete" nzTheme="outline"></span>
          </button>
        </a>
      </td>
    </tr>
  </tbody>
</nz-table>

<nz-modal
  [(nzVisible)]="isVisible"
  [nzTitle]="modalTitle"
  [nzContent]="modalContent"
  [nzFooter]="modalFooter"
  (nzOnCancel)="handleCancel()"
>
  <ng-template #modalTitle>{{
    isEdit ? "Edit Category" : "Add Category"
  }}</ng-template>

  <ng-template #modalContent>
    <form nz-form [formGroup]="categoryForm">
      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzRequired>Username</nz-form-label>
        <nz-form-control [nzSpan]="12" [nzErrorTip]="userErrorTpl">
          <input
            nz-input
            formControlName="catName"
            placeholder="Enter category name"
          />
          <ng-template #userErrorTpl let-control>
            <ng-container *ngIf="control.hasError('required')"
              >Please input your username!</ng-container
            >
          </ng-template>
        </nz-form-control>
      </nz-form-item>
      <!-- <nz-form-item>
        <nz-form-label [nzSpan]="7" nzRequired>File</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <div class="clearfix">
            <nz-upload (nzChange)="OnChange($event)" nzListType="picture">
              <button nz-button>
                <span nz-icon nzType="upload"></span>
                Upload
              </button>
            </nz-upload>
          </div>
        </nz-form-control>
      </nz-form-item> -->
    </form>
  </ng-template>
  <ng-template #modalFooter>
    <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
    <button
      nz-button
      nzType="primary"
      (click)="handleOk()"
      [nzLoading]="isConfirmLoading"
      [disabled]="!categoryForm.valid"
    >
      {{ isEdit ? "Update" : "Submit" }}
    </button>
  </ng-template>
</nz-modal>

<nz-dropdown-menu #menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input
        type="text"
        nz-input
        placeholder="Search name"
        [(ngModel)]="searchValue"
      />
      <button
        nz-button
        nzSize="small"
        nzType="primary"
        (click)="search()"
        class="search-button"
      >
        Search
      </button>
      <button nz-button nzSize="small" (click)="reset()">Reset</button>
    </div>
  </div>
</nz-dropdown-menu>
